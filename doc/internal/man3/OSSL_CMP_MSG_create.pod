=pod

=head1 NAME

OSSL_CMP_MSG_get_bodytype,
OSSL_CMP_MSG_set_bodytype,
OSSL_CMP_MSG_create,
OSSL_CMP_MSG_load,
OSSL_CMP_MSG_gen_ITAV_push0,
OSSL_CMP_MSG_gen_ITAVs_push1
- functions manipulating CMP messages

=head1 SYNOPSIS

  #include "cmp_int.h"

  int OSSL_CMP_MSG_get_bodytype(const OSSL_CMP_MSG *msg);
  int OSSL_CMP_MSG_set_bodytype( OSSL_CMP_MSG *msg, int type);
  OSSL_CMP_MSG *OSSL_CMP_MSG_create(OSSL_CMP_CTX *ctx, int bodytype);
  OSSL_CMP_MSG *OSSL_CMP_MSG_load(const char *file);
  int OSSL_CMP_MSG_gen_ITAV_push0(OSSL_CMP_MSG *msg, OSSL_CMP_ITAV *itav);
  int OSSL_CMP_MSG_gen_ITAVs_push1(OSSL_CMP_MSG *msg,
                                   STACK_OF(OSSL_CMP_ITAV) *itavs);

=head1 DESCRIPTION

OSSL_CMP_MSG_get_bodytype() returns the body type of the given PKIMessage.

OSSL_CMP_MSG_set_bodytype() sets the type of the message contained in
the PKIMessage body field.
Returns 1 on success, 0 on error.

OSSL_CMP_MSG_create() creates and initializes a OSSL_CMP_MSG structure,
using B<ctx> for the header and B<bodytype> for the body.
Returns pointer to created OSSL_CMP_MSG on success, NULL on error.

OSSL_CMP_MSG *OSSL_CMP_MSG_load() loads a OSSL_CMP_MSG from a B<file>.
Returns pointer to created OSSL_CMP_MSG on success, NULL on error.

OSSL_CMP_MSG_gen_ITAV_push0() pushes the B<itav> to the body of the
PKIMessage B<msg> of GenMsg or GenRep type. Consumes the B<itavs> pointer.
Returns 1 on success, 0 on error.

OSSL_CMP_MSG_gen_ITAVs_push1() adds a copy of the B<itavs> stack to the body
of the PKIMessage B<msg> of GenMsg or GenRep type.
Does not consume the B<itavs> pointer nor its elements.
Returns 1 on success, 0 on error.

=head1 NOTES

CMP is defined in RFC 4210 (and CRMF in RFC 4211).

=head1 RETURN VALUES

See the individual functions above.

=head1 SEE ALSO

L<OSSL_CMP_CTX_new(3)>, L<OSSL_CMP_certreq_new(3)>,
L<OSSL_CMP_exec_IR_ses(3)>, L<OSSL_CMP_MSG_http_perform(3)>

=head1 COPYRIGHT

Copyright 2007-2019 The OpenSSL Project Authors. All Rights Reserved.

Licensed under the Apache License 2.0 (the "License").  You may not use
this file except in compliance with the License.  You can obtain a copy
in the file LICENSE in the source distribution or at
L<https://www.openssl.org/source/license.html>.

=cut
